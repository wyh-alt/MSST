# MSST WebUI 安装包制作和使用指南

## 概述

本文档详细说明了如何制作和使用 MSST WebUI 的 Windows 安装包，该安装包支持在任意 Windows 平台进行部署安装。

## 安装包功能特性

### ✅ 核心功能
1. **自定义安装路径** - 用户可以选择安装目录
2. **临时用户目录设置** - 可配置上传/下载目录
3. **缓存目录自定义** - 可设置缓存文件存储位置
4. **服务器端口配置** - 自定义 WebUI 服务器端口
5. **初始账户设置** - 设置管理员用户名和密码
6. **桌面快捷方式** - 创建 MSST.bat 和配置管理工具快捷方式

### ✅ 技术特性
- 支持 Windows 10/11 (64位)
- 使用 Inno Setup 6 制作
- 多语言支持 (中文/英文)
- 自动目录创建和权限设置
- 配置文件自动生成
- 安装信息记录
- 完整的组件选择

## 制作安装包

### 前置要求

1. **Inno Setup 6**
   - 下载地址：https://jrsoftware.org/isinfo.php
   - 安装到默认位置

2. **必要文件**
   - `setup_enhanced_final.iss` - 安装脚本
   - `build_installer_final.bat` - 构建脚本
   - `installer_readme.md` - 安装说明
   - `verify_installation.py` - 安装验证脚本
   - `config_manager.py` - 配置管理工具
   - `MSST.bat` - 启动脚本
   - `docs/logo.ico` - 程序图标
   - `LICENSE` - 许可证文件

### 制作步骤

1. **准备文件**
   ```bash
   # 确保所有必要文件都在项目根目录
   ls -la setup_enhanced_final.iss
   ls -la build_installer_final.bat
   ls -la installer_readme.md
   ls -la verify_installation.py
   ls -la config_manager.py
   ls -la MSST.bat
   ls -la docs/logo.ico
   ls -la LICENSE
   ```

2. **运行构建脚本**
   ```bash
   # Windows 命令行
   build_installer_final.bat
   ```

3. **检查输出**
   - 安装包位置：`installer/MSST_WebUI_Setup_1.0.0.exe`
   - 检查文件大小和完整性

## 安装包使用

### 安装过程

1. **启动安装程序**
   - 双击 `MSST_WebUI_Setup_1.0.0.exe`
   - 需要管理员权限

2. **欢迎页面**
   - 阅读安装说明
   - 点击"下一步"

3. **许可协议**
   - 阅读并接受许可协议
   - 点击"下一步"

4. **选择安装路径**
   - 默认：`C:\Program Files\MSST WebUI`
   - 可自定义路径
   - 点击"下一步"

5. **选择组件**
   - **完整安装**：安装所有组件（推荐）
   - **自定义安装**：选择需要的组件
   - 点击"下一步"

6. **服务器端口设置**
   - 默认端口：7860
   - 可自定义端口 (1-65535)
   - 点击"下一步"

7. **管理员账户设置**
   - 设置用户名（默认：admin）
   - 设置密码（默认：admin123）
   - 点击"下一步"

8. **目录配置**
   - **输入目录**：临时输入文件存储位置
   - **输出目录**：处理结果输出位置
   - **缓存目录**：模型和临时文件缓存位置
   - 点击"下一步"

9. **桌面快捷方式**
   - 选择是否创建 MSST WebUI 快捷方式
   - 选择是否创建配置管理工具快捷方式
   - 点击"下一步"

10. **准备安装**
    - 确认安装信息
    - 点击"安装"

11. **安装完成**
    - 选择是否立即启动程序
    - 选择是否打开配置管理工具
    - 点击"完成"

### 安装后验证

1. **使用验证工具**
   ```bash
   # 在安装目录运行
   python verify_installation.py
   ```

2. **手动检查**
   - 检查桌面快捷方式
   - 检查开始菜单项
   - 检查配置文件
   - 检查目录结构

## 配置文件说明

### 自动生成的配置文件

1. **webui_config.json**
   - WebUI 主配置文件
   - 包含端口、目录、模型等设置

2. **user.json**
   - 用户账户配置
   - 包含用户名、密码、权限等

3. **client_config.json**
   - 客户端配置文件
   - 包含客户端端口、目录等设置

4. **install_config.json**
   - 安装记录文件
   - 记录安装路径、日期、版本等信息

### 配置修改

1. **使用配置管理工具**
   - 双击桌面快捷方式"配置管理工具"
   - 或运行：`python config_manager.py`

2. **手动修改**
   - 直接编辑 JSON 配置文件
   - 重启程序生效

## 目录结构

```
MSST WebUI/
├── workenv/                 # Python 环境
├── clientui/               # 客户端 UI
├── inference/              # 推理模块
├── modules/                # 模型模块
├── webui/                  # WebUI 模块
├── data/                   # 数据目录
├── configs/                # 配置目录
├── docs/                   # 文档目录
├── logs/                   # 日志目录
├── cache/                  # 缓存目录
├── input/                  # 输入目录
├── results/                # 结果目录
├── pretrain/               # 预训练模型目录
├── MSST.bat               # 启动脚本
├── config_manager.py      # 配置管理工具
├── verify_installation.py # 安装验证工具
└── ...                    # 其他文件
```

## 启动和使用

### 启动程序

1. **使用桌面快捷方式**
   - 双击"MSST WebUI"快捷方式

2. **使用开始菜单**
   - 开始菜单 → MSST WebUI → MSST WebUI

3. **直接运行**
   - 进入安装目录
   - 双击 `MSST.bat`

### 访问 WebUI

- **服务器地址**：http://localhost:端口号
- **客户端地址**：http://localhost:7861

### 配置管理

- 使用配置管理工具修改设置
- 支持修改端口、目录、用户等配置

## 卸载程序

### 卸载方法

1. **控制面板卸载**
   - 控制面板 → 程序和功能
   - 找到"MSST WebUI"
   - 点击"卸载"

2. **开始菜单卸载**
   - 开始菜单 → MSST WebUI → 卸载程序

3. **手动卸载**
   - 删除安装目录
   - 删除开始菜单项
   - 删除桌面快捷方式
   - 删除用户数据（可选）

### 卸载选项

- **保留用户数据**：保留配置文件、模型等
- **完全卸载**：删除所有相关文件

## 故障排除

### 常见问题

1. **安装失败**
   - 检查管理员权限
   - 检查磁盘空间
   - 检查防病毒软件

2. **启动失败**
   - 检查 Python 环境
   - 检查配置文件
   - 检查端口占用

3. **无法访问 WebUI**
   - 检查防火墙设置
   - 检查端口配置
   - 检查服务器状态

### 日志文件

- 安装日志：Windows 事件查看器
- 程序日志：`logs/` 目录
- 错误信息：控制台输出

## 技术支持

### 获取帮助

1. **项目地址**
   - GitHub：https://github.com/SUC-DriverOld/MSST-WebUI

2. **问题反馈**
   - 通过 GitHub Issues 提交
   - 提供详细的错误信息

3. **文档资源**
   - README.md
   - docs/ 目录下的文档

### 版本信息

- **当前版本**：1.0.0
- **更新日期**：2025年1月
- **兼容性**：Windows 10/11 (64位)

## 开发说明

### 修改安装脚本

1. **编辑 setup_enhanced_final.iss**
   - 修改版本号
   - 添加/删除文件
   - 修改安装选项

2. **重新构建**
   ```bash
   build_installer_final.bat
   ```

### 自定义配置

1. **修改默认值**
   - 编辑安装脚本中的默认值
   - 重新构建安装包

2. **添加新功能**
   - 修改安装脚本
   - 添加新的配置页面
   - 更新验证脚本

---

## 总结

MSST WebUI 安装包提供了完整的 Windows 部署解决方案，支持：

- ✅ 自定义安装路径
- ✅ 临时用户目录配置
- ✅ 缓存目录设置
- ✅ 服务器端口自定义
- ✅ 初始账户密码设置
- ✅ 桌面快捷方式创建
- ✅ 配置管理工具集成
- ✅ 安装验证功能
- ✅ 多语言支持
- ✅ 完整的卸载功能

该安装包可以在任意 Windows 平台进行部署安装，为用户提供便捷的安装和使用体验。
